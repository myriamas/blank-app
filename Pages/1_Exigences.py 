import streamlit as st
import pandas as pd

st.title("Exigences réglementaires – VAX-HIV-2030")

file = st.sidebar.file_uploader("Importer Exigences (CSV)", key="ex_req")

if file:
    df = pd.read_csv(file)

    type_filter = st.sidebar.multiselect("Filtrer par type d'exigence", df["Type d’exigence"].unique())
    phase_filter = st.sidebar.multiselect("Filtrer par phase", df["Phase concernée"].unique())
    statut_filter = st.sidebar.multiselect("Statut conformité", df["Statut conformité"].unique())

    filtered = df.copy()

    if type_filter:
        filtered = filtered[filtered["Type d’exigence"].isin(type_filter)]
    if phase_filter:
        filtered = filtered[filtered["Phase concernée"].isin(phase_filter)]
    if statut_filter:
        filtered = filtered[filtered["Statut conformité"].isin(statut_filter)]

    def color_status(val):
        if val == "Conforme":
            return "background-color:#d4f7d4"
        if val == "Partiel":
            return "background-color:#fff3b0"
        if val == "Non conforme":
            return "background-color:#ffb3b3"
        return ""

    st.dataframe(filtered.style.applymap(color_status, subset=["Statut conformité"]))
